rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Rules for the 'contacts' collection
    match /contacts/{contactId} {
      // Allow any authenticated user to create a contact submission.
      // This includes anonymous users for the public contact form.
      allow create: if request.auth != null;

      // Allow only the admin to read, update, or delete individual documents.
      allow get, update, delete: if request.auth.token.email.lower() == "beherajashobanta892@gmail.com";
    }

    // Allow the admin user to list the entire 'contacts' collection for the dashboard.
    match /contacts {
      allow list: if request.auth.token.email.lower() == "beherajashobanta892@gmail.com";
    }

    // Rules for the 'reviews' collection
    match /reviews/{reviewId} {
      // Allow any authenticated user to create a review.
      // This includes anonymous users for the public review form.
      allow create: if request.auth != null;

      // Allow only the admin to read, update, or delete individual reviews.
      allow get, update, delete: if request.auth.token.email.lower() == "beherajashobanta892@gmail.com";
    }

    // Allow the admin user to list the entire 'reviews' collection for the dashboard.
    match /reviews {
      allow list: if request.auth.token.email.lower() == "beherajashobanta892@gmail.com";
    }
  }
}
